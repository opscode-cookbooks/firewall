# firewalld_rich_rule

[Back to resource list](../README.md#resources)

## Provides

- `firewalld_rich_rule`

## Actions

- `:add`
- `:remove`

## Properties

| Name               | Type                                                                | Default    | Description                                                                                                                                                                                                                                                                                                                                                                                                |
|--------------------|---------------------------------------------------------------------|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `family`           | `[:ipv4, :ipv6]`                                                    | `:ipv4`    | IP family for the rule, either IPv4 or IPv6. If the family is not provided, the rule will be added for both IPv4 and IPv6. If source or destination addresses are used in the rule, then the rule family defaults to the type of address given in source and/or destination. This is also the case for port/packet forwarding. See rule "family" option in firewalld.richlanguage(5).                      |
| `zone`             | `String`                                                            |            | Zone in which to apply the rule. If not specified, the rule will be applied to the systems's default zone.                                                                                                                                                                                                                                                                                                 |
| `priority`         | `Integer`                                                           |            | Specifies the priority of the rule, ranging from -32768 to 32767. Lower values have higher precedence. See rule option "priority" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                               |
| `source`           | `String`                                                            |            | Source address or network range in CIDR notation to match for the rule. See "Source" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                            |
| `source_not`       | `String`                                                            |            | Excludes a specific source address or network range in CIDR notation from matching the rule. See "Source" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                       |
| `destination`      | `String`                                                            |            | Destination address or network range in CIDR notation to match for the rule. See "Destination" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                  |
| `destination_not`  | `String`                                                            |            | Excludes a specific destination address or network range in CIDR notation from matching the rule. See "Destination" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                             |
| `service`          | `String`                                                            |            | Service to apply the rule to, using firewalld's predefined service names. See \"Service\" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                       |
| `port`             | `[Integer, String]`                                                 |            | Single port or a range of ports to match for the rule. Requires the `protocol` property to also be specified. See "Port" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                        |
| `protocol`         | `String`                                                            |            | Defines the protocol by name or ID (e.g. tcp, udp, icmp). See "Protocol" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                        |
| `tcp_mss_clamp`    | `[String, Integer]`                                                 |            | Sets the maximum segment size (MSS) for TCP connections. See "Tcp-Mss-Clamp" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                    |
| `icmp_block`       | `String`                                                            |            | Blocks specific ICMP types (e.g. "echo-request") as defined by firewalld. A `rule_action` is not allowed with this property, "reject" is used implicitly. See "ICMP-Block" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                      |
| `masquerade`       | `[true, false]`                                                     | `false`    | Enables masquerading (NAT) for the rule. A `rule_action` is not allowed with this property, IP forwarding will be implicitly enabled. See "Masquerade" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                          |
| `icmp_type`        | `String`                                                            |            | Specifies the ICMP type to match (e.g. "echo-request"). See "ICMP-Type" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                         |
| `forward_port`     | `[Integer, String]`                                                 |            | Forward a local port or a range of local ports to another port locally or to another machine. Requires the `protocol` property and one or both of `to_port`/`to_address` properties. A `rule_action` is not allowed with this property, uses the action "accept" internally. See "Forward-Port" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html). |
| `to_port`          | `Integer`                                                           |            | The port to forward traffic to. See "Forward-Port" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                                              |
| `to_address`       | `String`                                                            |            | The IP address to forward traffic to. See "Forward-Port" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                                        |
| `source_port`      | `[Integer, String]`                                                 |            | The source port or range of source ports to match for the rule. Requires the `protocol` property to also be specified. See "Source-Port" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                        |
| `log`              | `[true, false]`                                                     | `false`    | Enables logging for the rule. See "Log" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                                                         |
| `log_prefix`       | `String`                                                            |            | Adds a prefix to log messages for identification. Maximum length is 127 characters. See "Log" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                   |
| `log_level`        | `[:emerg, :alert, :crit, :error, :warning, :notice, :info, :debug]` | `:warning` | Log level can be one of `:emerg`, `:alert`, `:crit`, `:error`, `:warning`, `:notice`, `:info`, `:debug`. Default is `:warning`. See "Log" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                       |
| `log_limit`        | `String`                                                            |            | Limits the rate of log messages in the format "rate/duration" (e.g., `5/s`). See "Limit" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                        |
| `nflog`            | `[true, false]`                                                     | `false`    | Log new connection attempts using kernel logging to pass the packets through a "netlink" socket to users or applications monitoring the multicast "group". See "NFLog" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                          |
| `nflog_group`      | `Integer`                                                           |            | The NFLOG group ID for the rule (0-65535). See NETLINK_NETFILTER in netlink(7) man page and NFLOG in both iptables-extensions(8) and nft(8) man pages for a more detailed description.                                                                                                                                                                                                                     |
| `nflog_prefix`     | `String`                                                            |            | Adds a prefix to NFLog messages for identification. Maximum length is 127 characters. See "NFLog" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                               |
| `nflog_queue_size` | `Integer`                                                           |            | Sets the queue size for NFLog messages. See "NFLog" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                                             |
| `nflog_limit`      | `String`                                                            |            | Limits the rate of NFLog messages in the format "rate/duration" (e.g. `10/m`). See "Limit" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                      |
| `audit`            | `[true, false]`                                                     | `false`    | Audit provides an alternative way for logging using audit records sent to the service auditd. Audit type will be discovered from the rule action automatically. See "Audit" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                     |
| `audit_limit`      | `String`                                                            |            | Limits the rate of audit messages in the format "rate/duration" (e.g. `1/s`). See "Limit" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                       |
| `rule_action`      | `[:accept, :reject, :drop, :mark]`                                  |            | The action for the rule. One of `:accept`, `:reject`, `:drop`, `:mark`. See "Action" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                            |
| `reject_type`      | `String`                                                            |            | Optional reject type to use with the `:reject` rule_action. See "Action" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                        |
| `mark_set`         | `String`                                                            |            | The mark value to set for matched packets (e.g. "0x1"). See "Action" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                                                            |
| `action_limit`     | `String`                                                            |            | Specifies a general rate limit for the rule in the format "rate/duration" (e.g. `20/s`). See "Limit" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                                                                                            |
| `raw`              | `String`                                                            |            | A raw rule string (e.g. \"rule ...\") passed directly to firewalld, bypassing this resource's internal validation and handling. All other properties are ignored. See \"Rule\" in [firewalld.richlanguage(5)](https://firewalld.org/documentation/man-pages/firewalld.richlanguage.html).                                                                                                                  |

## Examples

See the [recipe used for testing](../../test/fixtures/cookbooks/firewalld-test/recipes/default.rb).
